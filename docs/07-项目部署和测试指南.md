# AI Agent Platform - éƒ¨ç½²å’Œæµ‹è¯•æŒ‡å—

## ğŸ“‹ ç›®å½•
- [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
- [å¿«é€Ÿå¯åŠ¨](#å¿«é€Ÿå¯åŠ¨)
- [è¯¦ç»†éƒ¨ç½²æ­¥éª¤](#è¯¦ç»†éƒ¨ç½²æ­¥éª¤)
- [åŠŸèƒ½æµ‹è¯•](#åŠŸèƒ½æµ‹è¯•)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)

## ğŸ”§ ç¯å¢ƒè¦æ±‚

### åŸºç¡€ç¯å¢ƒ
- **Java**: 17+
- **Node.js**: 18+
- **Docker**: 20.10+
- **Docker Compose**: 2.0+
- **Maven**: 3.8+
- **Git**: 2.30+

### ç³»ç»Ÿèµ„æº
- **å†…å­˜**: æœ€å°‘ 8GBï¼Œæ¨è 16GB
- **å­˜å‚¨**: æœ€å°‘ 20GB å¯ç”¨ç©ºé—´
- **CPU**: 4æ ¸å¿ƒä»¥ä¸Š

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd agent-box
```

### 2. å¯åŠ¨åŸºç¡€æœåŠ¡
```bash
# å¯åŠ¨æ•°æ®åº“å’Œä¸­é—´ä»¶
docker-compose up -d postgres redis chroma minio rabbitmq

# ç­‰å¾…æœåŠ¡å¯åŠ¨å®Œæˆï¼ˆçº¦30ç§’ï¼‰
docker-compose ps
```

### 3. å¯åŠ¨åç«¯æœåŠ¡
```bash
cd backend

# ç¼–è¯‘é¡¹ç›®
mvn clean compile -DskipTests

# å¯åŠ¨åº”ç”¨
mvn spring-boot:run
```

### 4. å¯åŠ¨å‰ç«¯æœåŠ¡
```bash
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### 5. è®¿é—®åº”ç”¨
- **å‰ç«¯**: http://localhost:3000
- **åç«¯API**: http://localhost:8080/api
- **APIæ–‡æ¡£**: http://localhost:8080/swagger-ui.html

## ğŸ“ è¯¦ç»†éƒ¨ç½²æ­¥éª¤

### æ•°æ®åº“åˆå§‹åŒ–

1. **æ£€æŸ¥æ•°æ®åº“è¿æ¥**
```bash
docker exec -it agent-postgres psql -U agent_user -d agent_platform
```

2. **éªŒè¯è¡¨ç»“æ„**
```sql
\dt
-- åº”è¯¥çœ‹åˆ°æ‰€æœ‰ä¸šåŠ¡è¡¨
```

3. **åˆå§‹åŒ–æ•°æ®**
```sql
-- åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·
INSERT INTO users (username, email, password, role, enabled) 
VALUES ('admin', 'admin@example.com', '$2a$10$...', 'ADMIN', true);
```

### æœåŠ¡é…ç½®

1. **åç«¯é…ç½®** (`backend/src/main/resources/application.yml`)
```yaml
server:
  port: 8080

spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/agent_platform
    username: agent_user
    password: agent_password
  
  redis:
    host: localhost
    port: 6379
    
langchain4j:
  open-ai:
    api-key: ${OPENAI_API_KEY:your-api-key}
    base-url: ${OPENAI_BASE_URL:https://api.openai.com/v1}
```

2. **å‰ç«¯é…ç½®** (`frontend/.env`)
```env
VITE_API_BASE_URL=http://localhost:8080/api
VITE_APP_TITLE=AI Agent Platform
```

### Docker ç”Ÿäº§éƒ¨ç½²

1. **æ„å»ºé•œåƒ**
```bash
# åç«¯é•œåƒ
cd backend
docker build -t agent-platform-backend .

# å‰ç«¯é•œåƒ
cd frontend
docker build -t agent-platform-frontend .
```

2. **ç”Ÿäº§ç¯å¢ƒå¯åŠ¨**
```bash
# ä½¿ç”¨ç”Ÿäº§é…ç½®
docker-compose -f docker-compose.prod.yml up -d
```

## ğŸ§ª åŠŸèƒ½æµ‹è¯•

### 1. ç”¨æˆ·è®¤è¯æµ‹è¯•

```bash
# æ³¨å†Œç”¨æˆ·
curl -X POST http://localhost:8080/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "email": "test@example.com",
    "password": "password123"
  }'

# ç”¨æˆ·ç™»å½•
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "password123"
  }'
```

### 2. çŸ¥è¯†åº“åŠŸèƒ½æµ‹è¯•

```bash
# åˆ›å»ºçŸ¥è¯†åº“
curl -X POST http://localhost:8080/api/knowledge/bases \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "æµ‹è¯•çŸ¥è¯†åº“",
    "description": "ç”¨äºæµ‹è¯•çš„çŸ¥è¯†åº“"
  }'

# ä¸Šä¼ æ–‡æ¡£
curl -X POST http://localhost:8080/api/knowledge/documents \
  -H "Authorization: Bearer <token>" \
  -F "file=@test.pdf" \
  -F "knowledgeBaseId=1"
```

### 3. å·¥ä½œæµåŠŸèƒ½æµ‹è¯•

```bash
# åˆ›å»ºå·¥ä½œæµ
curl -X POST http://localhost:8080/api/workflows \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "æµ‹è¯•å·¥ä½œæµ",
    "description": "ç®€å•çš„æµ‹è¯•å·¥ä½œæµ",
    "definition": {
      "nodes": [...],
      "edges": [...]
    }
  }'
```

### 4. MCP æœåŠ¡æµ‹è¯•

```bash
# å‘å¸ƒæœåŠ¡
curl -X POST http://localhost:8080/api/mcp/services \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "test-service",
    "displayName": "æµ‹è¯•æœåŠ¡",
    "description": "ç”¨äºæµ‹è¯•çš„MCPæœåŠ¡",
    "dockerImage": "nginx:latest"
  }'
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®åº“è¿æ¥å¤±è´¥**
```bash
# æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
docker-compose ps postgres

# æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
docker-compose logs postgres

# é‡å¯æ•°æ®åº“
docker-compose restart postgres
```

2. **Redis è¿æ¥é—®é¢˜**
```bash
# æµ‹è¯• Redis è¿æ¥
docker exec -it agent-redis redis-cli ping

# æ¸…ç©º Redis ç¼“å­˜
docker exec -it agent-redis redis-cli flushall
```

3. **å‘é‡æ•°æ®åº“é—®é¢˜**
```bash
# æ£€æŸ¥ Chroma çŠ¶æ€
curl http://localhost:8000/api/v1/heartbeat

# é‡å¯ Chroma
docker-compose restart chroma
```

4. **åç«¯å¯åŠ¨å¤±è´¥**
```bash
# æ£€æŸ¥ Java ç‰ˆæœ¬
java -version

# æ¸…ç†å¹¶é‡æ–°ç¼–è¯‘
mvn clean compile -DskipTests

# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
mvn spring-boot:run -X
```

5. **å‰ç«¯ç¼–è¯‘é”™è¯¯**
```bash
# æ¸…ç†ä¾èµ–
rm -rf node_modules package-lock.json
npm install

# è·³è¿‡ç±»å‹æ£€æŸ¥å¯åŠ¨
npm run dev -- --host
```

### æ—¥å¿—æŸ¥çœ‹

1. **åº”ç”¨æ—¥å¿—**
```bash
# åç«¯æ—¥å¿—
tail -f backend/logs/application.log

# Docker å®¹å™¨æ—¥å¿—
docker-compose logs -f backend
```

2. **æ•°æ®åº“æ—¥å¿—**
```bash
# PostgreSQL æ—¥å¿—
docker-compose logs postgres

# æ…¢æŸ¥è¯¢æ—¥å¿—
docker exec -it agent-postgres psql -U agent_user -d agent_platform -c "SELECT * FROM pg_stat_activity;"
```

## âš¡ æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–

1. **ç´¢å¼•ä¼˜åŒ–**
```sql
-- ä¸ºå¸¸ç”¨æŸ¥è¯¢æ·»åŠ ç´¢å¼•
CREATE INDEX idx_documents_knowledge_base_id ON documents(knowledge_base_id);
CREATE INDEX idx_workflows_user_id ON workflows(user_id);
CREATE INDEX idx_mcp_services_status ON mcp_services(status);
```

2. **è¿æ¥æ± é…ç½®**
```yaml
spring:
  datasource:
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
```

### ç¼“å­˜ä¼˜åŒ–

1. **Redis é…ç½®**
```yaml
spring:
  redis:
    timeout: 2000ms
    lettuce:
      pool:
        max-active: 8
        max-idle: 8
        min-idle: 0
```

2. **åº”ç”¨ç¼“å­˜**
```java
@Cacheable(value = "knowledge-bases", key = "#userId")
public List<KnowledgeBase> getUserKnowledgeBases(Long userId) {
    // å®ç°
}
```

### JVM ä¼˜åŒ–

```bash
# ç”Ÿäº§ç¯å¢ƒ JVM å‚æ•°
export JAVA_OPTS="-Xms2g -Xmx4g -XX:+UseG1GC -XX:MaxGCPauseMillis=200"
mvn spring-boot:run
```

### å‰ç«¯ä¼˜åŒ–

1. **æ„å»ºä¼˜åŒ–**
```javascript
// vite.config.ts
export default defineConfig({
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom'],
          antd: ['antd'],
          utils: ['lodash', 'dayjs']
        }
      }
    }
  }
})
```

2. **CDN é…ç½®**
```html
<!-- ä½¿ç”¨ CDN åŠ é€Ÿ -->
<link rel="dns-prefetch" href="//cdn.jsdelivr.net">
```

## ğŸ“Š ç›‘æ§å’Œå‘Šè­¦

### å¥åº·æ£€æŸ¥

1. **åº”ç”¨å¥åº·æ£€æŸ¥**
```bash
# åç«¯å¥åº·æ£€æŸ¥
curl http://localhost:8080/actuator/health

# æ•°æ®åº“å¥åº·æ£€æŸ¥
curl http://localhost:8080/actuator/health/db
```

2. **æœåŠ¡ç›‘æ§**
```yaml
# docker-compose.yml æ·»åŠ å¥åº·æ£€æŸ¥
services:
  backend:
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/actuator/health"]
      interval: 30s
      timeout: 10s
      retries: 3
```

### æ€§èƒ½ç›‘æ§

1. **JVM ç›‘æ§**
```bash
# å¯ç”¨ JMX
export JAVA_OPTS="$JAVA_OPTS -Dcom.sun.management.jmxremote"
```

2. **æ•°æ®åº“ç›‘æ§**
```sql
-- æŸ¥çœ‹æ´»è·ƒè¿æ¥
SELECT * FROM pg_stat_activity WHERE state = 'active';

-- æŸ¥çœ‹æ…¢æŸ¥è¯¢
SELECT query, mean_time, calls FROM pg_stat_statements ORDER BY mean_time DESC LIMIT 10;
```

## ğŸ”’ å®‰å…¨é…ç½®

### HTTPS é…ç½®

1. **SSL è¯ä¹¦**
```yaml
server:
  ssl:
    key-store: classpath:keystore.p12
    key-store-password: password
    key-store-type: PKCS12
    key-alias: tomcat
```

2. **åå‘ä»£ç†**
```nginx
server {
    listen 443 ssl;
    server_name your-domain.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    location / {
        proxy_pass http://localhost:3000;
    }
    
    location /api {
        proxy_pass http://localhost:8080;
    }
}
```

### å®‰å…¨å¤´é…ç½®

```yaml
spring:
  security:
    headers:
      frame-options: DENY
      content-type-options: nosniff
      xss-protection: 1; mode=block
```

## ğŸ“ˆ æ‰©å±•éƒ¨ç½²

### é›†ç¾¤éƒ¨ç½²

1. **è´Ÿè½½å‡è¡¡**
```yaml
# docker-compose.cluster.yml
services:
  backend:
    deploy:
      replicas: 3
    ports:
      - "8080-8082:8080"
```

2. **æ•°æ®åº“é›†ç¾¤**
```yaml
services:
  postgres-master:
    image: postgres:15
    environment:
      POSTGRES_REPLICATION_MODE: master
      
  postgres-slave:
    image: postgres:15
    environment:
      POSTGRES_REPLICATION_MODE: slave
      POSTGRES_MASTER_SERVICE: postgres-master
```

### Kubernetes éƒ¨ç½²

```yaml
# k8s-deployment.yml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: agent-platform-backend
spec:
  replicas: 3
  selector:
    matchLabels:
      app: agent-platform-backend
  template:
    metadata:
      labels:
        app: agent-platform-backend
    spec:
      containers:
      - name: backend
        image: agent-platform-backend:latest
        ports:
        - containerPort: 8080
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: "prod"
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°éƒ¨ç½²é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. ç¯å¢ƒè¦æ±‚æ˜¯å¦æ»¡è¶³
2. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
3. ç«¯å£æ˜¯å¦è¢«å ç”¨
4. æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

æ›´å¤šæŠ€æœ¯æ”¯æŒï¼Œè¯·å‚è€ƒé¡¹ç›®æ–‡æ¡£æˆ–æäº¤ Issueã€‚